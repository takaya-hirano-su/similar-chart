{% extends "main/base.html" %}
{%load static%}

{% block css-content %}
<link rel="stylesheet" type="text/css" href="{% static 'main/css/style.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'trade_training/css/style.css' %}">
{% endblock %}

{% block main-content %}
<h1>仮想トレード</h1>
<div class="contents">
    <form action="{% url 'trade' %}" method="post" name="trade_form">
        <table>
            {% csrf_token %}
            {{market_pair_form.as_table}}
        </table>

        <h2>残高</h2>
        <canvas id="pair-bar" width="1000" height="130">No Data...</canvas>

        <h3>BID/ASK ({{quote.datetime|date:"Y/m/d H:i"}})</h3>
        <div class="flex-quote">
            <div class="quote">
                <div>BID<br>(売値)</div>
                <div>{{user_currency.currency.symbol}}{{quote.bid}}</div>
            </div>
            <div class="quote">
                <div>ASK<br>(買値)</div>
                <div>{{user_currency.currency.symbol}}{{quote.ask}}</div>
            </div>
        </div>

        <table>
            {% csrf_token %}
            {{trade_form.as_table}}
            <tr>
                <td></td>
                <td>
                    <input type="submit" value="注文" id="commit-button">
                </td>
            </tr>
        </table>
    </form>
</div>
{% endblock %}

{% block js-content %}
<script type="text/javascript">
    var crypto_lot='{{user_coin.lot}}'
    var crypto_price=parseFloat(crypto_lot)*parseFloat('{{quote.bid}}'); //今持ってるコインの価値
    var currency=parseFloat('{{user_currency.price}}'); //通貨(日本円とかUSドルとか)の残金
    var pair_name='{{user_coin.pair.pair}}'.toUpperCase();

    var name_currency='{{user_currency.currency.currency}}';
    var symbol_currency='{{user_currency.currency.symbol}}'
    var label_currency=name_currency+" "+symbol_currency+'{{user_currency.price}}';

    var name_crypto=pair_name.replace(name_currency,"");
    var label_crypto=name_crypto+" "+crypto_lot+" ( "+symbol_currency+String(crypto_price)+" ) ";
</script>
<script src="{% static 'trade_training\js\script.js' %}"></script>
{% endblock %}